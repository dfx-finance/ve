// SPDX-License-Identifier: AGPL-3.0
pragma solidity ^0.8.19;

import "forge-std/Script.sol";
import "../src/interfaces/IRewardsOnlyGauge.sol";
import "../src/interfaces/IDfxUpgradeableProxy.sol";

import "./upgrades/IRewardsOnlyGaugeUpgrade.sol";

contract RecoverClaimSigScript is Script {
    address polygonStreamer = 0xfA707fD6c519adA3995B9358774b4289114dB534;
    address polygonGauge = 0xf0453d9642Df3e2fD46e7046D7A90F05702BF9dd;
    address polygonLpt = 0xFe1128E43580b3DF1e7042e0586c9179c3a416DC;
    address polygonImplementation = 0xc43e41340ea60a4b364Fdf35477a36DC96c92967;

    address multisig = 0x80D27bfb638F4Fea1e862f1bd07DEa577CB77D38;
    address proxyAdmin = 0x9aDa42ed163bB45ea2FF11c06c59cF27d27E6cba;
    address user = 0xde0223237AE9776a0654fdA6816cDAC50eDd72B5;
    address dfx = 0x27f485b62C4A7E635F561A87560Adf5090239E93;

    function run() external {
        // IDfxUpgradeableProxy proxy = IDfxUpgradeableProxy(payable(polygonGauge));
        // vm.startPrank(proxyAdmin);
        // proxy.upgradeTo(polygonImplementation);
        // vm.stopPrank();

        // IRewardsOnlyGaugeUpgrade gauge = IRewardsOnlyGaugeUpgrade(polygonGauge);
        // console2.log(gauge.admin());

        bytes memory newBytecode =
            "3461196f57601c5461196f576001601c5561194c6100226100003961194c610000f36003361161000c576112e7565b60003560e01c3461193a5763485cc955811861029b576044361061193a576004358060a01c61193a576040526024358060a01c61193a57606052601c5461193a576001601c556060516306fdde0360c052606060c0600460dc845afa610077573d600060003e3d6000fd5b60403d1061193a5760c05160c001601a81511161193a578051806101405260208201805161016052505050610140905080518060805260208201805160a0525050506060516395d89b41610100526060610100600461011c845afa6100e1573d600060003e3d6000fd5b60403d1061193a576101005161010001601a81511161193a57805180610180526020820180516101a052505050610180905080518060c05260208201805160e05250505060006004610100527f444658200000000000000000000000000000000000000000000000000000000061012052610100805160208201836101a00181518152505080830192505050608051816101a00160a051815250808201915050600c610140527f205265776172644761756765000000000000000000000000000000000000000061016052610140805160208201836101a001815181525050808301925050508061018052610180905080518060055560208201600082601f0160051c6002811161193a57801561020b57905b8060051b83015181600601556001018181186101f4575b5050505050600060c051816101600160e0518152508082019150506006610100527f2d676175676500000000000000000000000000000000000000000000000000006101205261010080516020820183610160018151815250508083019250505080610140526101409050805180600855602082018051600955505050606051600155604051601a556001601c55005b63313ce56781186102b9576004361061193a57601260405260206040f35b63bf88a6ff81186102f9576004361061193a57600a5473ffffffffffffffffffffffffffffffffffffffff811690508060a01c61193a5760405260206040f35b633488bd19811861031e576004361061193a57600a548060a01c905060405260206040f35b63e77e7437811861038d576044361061193a576004358060a01c61193a576040526024358060a01c61193a57606052601960405160205260005260406000208060605160205260005260406000209050546fffffffffffffffffffffffffffffffff8116905060805260206080f35b6333fd6f7481186103ed576044361061193a576004358060a01c61193a576040526024358060a01c61193a57606052601960405160205260005260406000208060605160205260005260406000209050548060801c905060805260206080f35b6359b7e409811861048a576044361061193a576004358060a01c61193a57610380526024358060a01c61193a576103a05260005460021461193a576002600055600b541561045057610380516040526003546060526040366080376104506112ed565b6019610380516020526000526040600020806103a05160205260005260406000209050548060801c90506103c05260206103c06003600055f35b63bdf9811681186104bf576024361061193a576004358060a01c61193a57604052604051601433602052600052604060002055005b63e6f1daf281186104e2576004361061193a57336103805260006103a052610541565b6384e9bd7e811861050f576024361061193a576004358060a01c61193a576103805260006103a052610541565b639faceb1b811861058c576044361061193a576004358060a01c61193a57610380526024358060a01c61193a576103a0525b60005460021461193a5760026000556103a051156105645733610380511861193a575b6103805160405260035460605260016080526103a05160a0526105856112ed565b6003600055005b63b6b55f2581186105af576024361061193a57336103805260006103a05261060e565b636e553f6581186105dc576044361061193a576024358060a01c61193a576103805260006103a05261060e565b6383df67478118610799576064361061193a576024358060a01c61193a57610380526044358060011c61193a576103a0525b60005460021461193a5760026000556004351561072c57600a5473ffffffffffffffffffffffffffffffffffffffff811690508060a01c61193a576103c0526003546103e052610380516040526103e0516060526103a051608052600060a0526106766112ed565b6103e05160043580820182811061193a57905090506103e05260026103805160205260005260406000205460043580820182811061193a579050905061040052610400516002610380516020526000526040600020556103e0516003556001546323b872dd6104205233610440523061046052600435610480526020610420606461043c6000855af161070e573d600060003e3d6000fd5b60203d1061193a57610420518060011c61193a576104a0526104a050505b610380517fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c6004356103c05260206103c0a26103805160007fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef6004356103c05260206103c0a36003600055005b632e1a7d4d81186107b7576024361061193a576000610380526107da565b6338d074368118610951576044361061193a576024358060011c61193a57610380525b60005460021461193a576002600055600435156108ea57600a5473ffffffffffffffffffffffffffffffffffffffff811690508060a01c61193a576103a0526003546103c052336040526103c05160605261038051608052600060a05261083f6112ed565b6103c05160043580820382811161193a57905090506103c05260023360205260005260406000205460043580820382811161193a57905090506103e0526103e0516002336020526000526040600020556103c05160035560015463a9059cbb610400523361042052600435610440526020610400604461041c6000855af16108cc573d600060003e3d6000fd5b60203d1061193a57610400518060011c61193a576104605261046050505b337f884edad9ce6fa2440d8a54cc123490eb96d2768479d49ff9c7366125a94243646004356103a05260206103a0a26000337fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef6004356103a05260206103a0a36003600055005b63a9059cbb81186109b0576044361061193a576004358060a01c61193a576104405260005460021461193a5760026000553361038052610440516103a0526024356103c05261099e611814565b60016104605260206104606003600055f35b6323b872dd8118610aa7576064361061193a576004358060a01c61193a57610440526024358060a01c61193a576104605260005460021461193a576002600055600461044051602052600052604060002080336020526000526040600020905054610480527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6104805114610a76576104805160443580820382811161193a57905090506004610440516020526000526040600020803360205260005260406000209050555b6104405161038052610460516103a0526044356103c052610a95611814565b60016104a05260206104a06003600055f35b63095ea7b38118610b26576044361061193a576004358060a01c61193a576040526024356004336020526000526040600020806040516020526000526040600020905055604051337f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560243560605260206060a3600160605260206060f35b63395093518118610bd9576044361061193a576004358060a01c61193a57604052600433602052600052604060002080604051602052600052604060002090505460243580820182811061193a57905090506060526060516004336020526000526040600020806040516020526000526040600020905055604051337f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560605160805260206080a3600160805260206080f35b63a457c2d78118610c8c576044361061193a576004358060a01c61193a57604052600433602052600052604060002080604051602052600052604060002090505460243580820382811161193a57905090506060526060516004336020526000526040600020806040516020526000526040600020905055604051337f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560605160805260206080a3600160805260206080f35b6347d2d5d38118610e9657610144361061193a576004358060a01c61193a57610380526044358060a01c61193a576103a0526064358060a01c61193a576103c0526084358060a01c61193a576103e05260a4358060a01c61193a576104005260c4358060a01c61193a576104205260e4358060a01c61193a5761044052610104358060a01c61193a5761046052610124358060a01c61193a576104805260005460021461193a576002600055601a54331861193a576001546104a052600a5473ffffffffffffffffffffffffffffffffffffffff811690508060a01c61193a576104c0526003546104e05260006040526104e051606052604036608037610d916112ed565b6103805115610dae576103a0511561193a57610380513b1561193a575b61038051600a5560243561050052610500601c810180516105405250600461052052610520905080518060155560208201805160165550505060006008905b8061050052610500516007811161193a57600b015461052052610500516007811161193a5760051b6103a00151610540526105205115610e395761054051610520511861193a57610e5f565b6105405115610e6a5761054051610500516007811161193a57600b0155610e5f56610e6a565b600101818118610ded575b50506103805115610e8f5760006040526104e051606052604036608037610e8f6112ed565b6003600055005b636b441a408118610ef4576024361061193a576004358060a01c61193a57604052601a54331861193a57604051601b557f2f56810a6bf40af059b96d3aea4db54081f378029a518390491093a7b67032e960405160605260206060a1005b63e5ea47b88118610f4a576004361061193a57601b54604052604051331861193a57604051601a557febee2d5739011062cb4f14113f3b36bf0ffe3da5c0568f64189d1012a118910560405160605260206060a1005b6382c630668118610f69576004361061193a5760015460405260206040f35b6370a082318118610fa4576024361061193a576004358060a01c61193a57604052600260405160205260005260406000205460605260206060f35b6318160ddd8118610fc3576004361061193a5760035460405260206040f35b63dd62ed3e811861101d576044361061193a576004358060a01c61193a576040526024358060a01c61193a576060526004604051602052600052604060002080606051602052600052604060002090505460805260206080f35b6306fdde0381186110a2576004361061193a576020806040528060400160055480825260208201600082601f0160051c6002811161193a57801561107457905b80600601548160051b84015260010181811861105d575b505050508051806020830101601f82600003163682375050601f19601f825160200101169050810190506040f35b6395d89b4181186110fa576004361061193a576020806040528060400160085480825260208201600954815250508051806020830101601f82600003163682375050601f19601f825160200101169050810190506040f35b6354c49fe98118611125576024361061193a576004356007811161193a57600b015460405260206040f35b63fe9e21788118611160576024361061193a576004358060a01c61193a57604052601360405160205260005260406000205460605260206060f35b6301ddabf1811861119b576024361061193a576004358060a01c61193a57604052601460405160205260005260406000205460605260206060f35b63b7aca56881186111f3576004361061193a576020806040528060400160155480825260208201601654815250508051806020830101601f82600003163682375050601f19601f825160200101169050810190506040f35b6373861fb3811861122e576024361061193a576004358060a01c61193a57604052601760405160205260005260406000205460605260206060f35b63f05cc0588118611288576044361061193a576004358060a01c61193a576040526024358060a01c61193a576060526018604051602052600052604060002080606051602052600052604060002090505460805260206080f35b63f851a44081186112a7576004361061193a57601a5460405260206040f35b6317f7182a81186112c6576004361061193a57601b5460405260206040f35b63158ef93e81186112e5576004361061193a57601c5460405260206040f35b505b60006000fd5b600a5460c052606051156113285760c051156113215760c0518060a01c9050610e10810181811061193a579050421161132b565b600061132b565b60005b156113a85760c05173ffffffffffffffffffffffffffffffffffffffff811690508060a01c61193a5760e05260155480610100526016546101205250610100506000600061010051610120600060e0515af161138c573d600060003e3d6000fd5b60e051428060a01b905080820182811061193a5790509050600a555b60a05160e0526080516113bc5760006113c1565b60e051155b156113e857601460405160205260005260406000205460e05260e0516113e85760405160e0525b60026040516020526000526040600020546101005260006008905b8061012052610120516007811161193a57600b0154610140526101405161142957611810565b6000610160526060511561152057610140516370a082316101a052306101c05260206101a060246101bc845afa611465573d600060003e3d6000fd5b60203d1061193a576101a0905051610180526101805160136101405160205260005260406000205480820382811161193a5790509050670de0b6b3a7640000810281670de0b6b3a764000082041861193a579050606051801561193a5780820490509050610160526101805160136101405160205260005260406000205560405161152057610160511561180557601761014051602052600052604060002080546101605180820182811061193a5790509050815550611805565b6017610140516020526000526040600020546101605180820182811061193a579050905061018052610160511561156857610180516017610140516020526000526040600020555b60186101405160205260005260406000208060405160205260005260406000209050546101a05260006101c052610180516101a051101561160a5761018051601861014051602052600052604060002080604051602052600052604060002090505561010051610180516101a05180820382811161193a579050905080820281158383830414171561193a5790509050670de0b6b3a7640000810490506101c0525b60196040516020526000526040600020806101405160205260005260406000209050546101e0526101e0518060801c90506101c05180820182811061193a5790509050610200526102005115611805576101e0516fffffffffffffffffffffffffffffffff81169050610220526080516116cb576101c051156118055761022051610200518060801b905080820182811061193a57905090506019604051602052600052604060002080610140516020526000526040600020905055611805565b60006004610280527fa9059cbb000000000000000000000000000000000000000000000000000000006102a052610280805160208201836102e0018151815250508083019250505060e051816102e0015260208101905061020051816102e00152602081019050806102c0526102c0505060206103606102c0516102e06000610140515af161175f573d600060003e3d6000fd5b3d602081183d602010021861034052610340805180610240526020820180516102605250505061024051156117a357610260516102405160200360031b1c1561193a575b601361014051602052600052604060002080546102005180820382811161193a5790509050815550610220516102005180820182811061193a579050905060196040516020526000526040600020806101405160205260005260406000209050555b600101818118611403575b5050565b600a5473ffffffffffffffffffffffffffffffffffffffff811690508060a01c61193a576103e0526103c05115611901576003546104005261038051604052610400516060526040366080376118686112ed565b6002610380516020526000526040600020546103c05180820382811161193a579050905061042052610420516002610380516020526000526040600020556103a051604052610400516060526040366080376118c26112ed565b60026103a0516020526000526040600020546103c05180820182811061193a5790509050610420526104205160026103a0516020526000526040600020555b6103a051610380517fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef6103c051610400526020610400a3565b600080fda165767970657283000307000b005b600080fd";

        address newContract;
        assembly {
            mstore(0x0, newBytecode)
            newContract := create(0, add(newBytecode, 0x20), mload(newBytecode))
        }
        require(newContract != address(0), "deployed failed");
    }
}
